# tcpdump

### Установка

Ubuntu/Debian:
```
sudo apt install tcpdump
```
В Fedora/Red Hat/CentOS:
```
sudo yum install tcpdump
```


### Использование

* **Указать интерфейс**
```
tcpdump -i eth0
```

* **Ограничить количество захватываемых пакетов до 5**
```
tcpdump -c 5 -i eth0
```

* **Вывести захваченные данные в ASCII**
```
tcpdump -A -i eth0
```

* **Вывести доступные интерфейсы**
```
tcpdump -D
```

* **Вывести захваченные данные в HEX и ASCII**
```
tcpdump -XX -i eth0
```

* **Сохранить захваченные данные в файл в pcap формате**
```
tcpdump -w 0001.pcap -i eth0
```

* **Вывести данные из файла в pcap формате**
```
tcpdump -r 0001.pcap
```

* **Захватывать IP адрес**
```
tcpdump -n -i eth0
```

* **Захватывать только tcp пакеты**
```
tcpdump -i eth0 tcp
```

* **Захватывать только пакеты которые идут от/на 22 порт**
```
tcpdump -i eth0 port 22
```

* **Захватывать только пакеты которые идут с конкретного IP**
```
tcpdump -i eth0 src 192.168.0.2
```

* **Захватывать только пакеты которые идут на конкретный IP**
```
tcpdump -i eth0 dest 192.168.0.4
```
