# Wireshark

[Документация](https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html "САЙТ")

[Учебник](https://wireshark.wiki/wiki/ "САЙТ")


### Основные операторы

##### 1. Логические операторы:
* **and:** Логическое И. Например: ip.src == 192.168.1.1 and tcp.port == 80.
* **or:** Логическое ИЛИ. Например: tcp.port == 80 or tcp.port == 443.
* **not:** Логическое НЕ. Например: not icmp.

##### 2. Относительные операторы:
* **==:** Равно. Например: ip.src == 192.168.1.1.
* **!=:** Не равно. Например: ip.src != 192.168.1.1.
* **<:** Меньше. Например: tcp.port < 1024.
* **>:** Больше. Например: tcp.port > 1024.
* **<=:** Меньше или равно. Например: tcp.port <= 80.
* **>=:** Больше или равно. Например: tcp.port >= 443.

##### 3. Диапазоны и маски:
* **range:** Диапазон значений. Например: tcp.port range 1-1024.
* **net:** Сетевой адрес и маска. Например: ip.addr net 192.168.1.0/24.

##### 4. Строковые операторы:
* **contains:** Содержит подстроку. Например: http contains "login".
* **matches:** Соответствует регулярному выражению. Например: http.host matches ".*example\.com.*".

##### 5. Прочие операторы:
* **in:** Принадлежность к списку значений. Например: tcp.port in {80, 443}.


### Фильтрация

Для отображения определенного IP
```
ip.addr == xxx.xxx.xxx.xxx
```

Для отображения пакетов от источника и получателя
```
ip.src == xxx.xxx.xxx.xxx && ip.dst == xxx.xxx.xxx.xxx
```

Для отображения пакетов определенного порта и источника
```
tcp.port == 80 or http #Note: при указании здесь только имени службы возникает ошибка *недопустимый номер*.
udp.port == 3389 or rdp
tcp.port == 21 or ftp
tcp.port == 22 or ssh
```

Только для отображения исходящих пакетов из кадра управления.
```
wlan.fc.type==0
```

Для отображения входящих, исходящих пакетов через контрольный кадр.
```
wlan.fc.type==1
```

Показывать пакеты, переданные через фрейм данных.
```
wlan.fc.type==2
```

Перечисление ассоциации запросов.
```
wlan.fc.type_subtype==0
```

Перечисление ассоциации ответов.
```
wlan.fc.type_subtype==1
```

Исследование списка запросов.
```
wlan.fc.type_subtype==4
```

Перечисляет ответы исследования
```
wlan.fc.type_subtype==5
```

Перечисляет запросы аутентификации.
```
wlan.fc.type_subtype==11
```

Перечисляет запросы деаутентификации.
```
wlan.fc.type_subtype==12
```

TCP — перечисляет исходящие пакеты на порт xx.
```
tcp.port == xx
```

TCP — перечисляет пакеты с портом источника xx.
```
tcp.srcport == xx
```

TCP — перечисляет пакеты с портом назначения xx.
```
tcp.dstport == xx
```

UDP — выводит список исходящих пакетов на порт xx.
```
udp.port == xx
```

UDP — перечисляет пакеты с портом назначения xx.
```
udp.srcport == xx
```

В UDP перечислены пакеты с портом источника xx.
```
udp.dstport == xx
```

Перечисляет HTTP-запросы Get.
```
http.request
```

Перечисляет пакеты для MAC-адреса источника или назначения.
```
wlan.sa == MAC-Address
```

Перечисляет пакеты с целевым mac-адресом.
```
wlan.da == MAC-Address
```
